import xlrd
import redis

r = redis.Redis(host="192.168.2.135",port=6379,db=1)

data = xlrd.open_workbook('/var/bigdata/learnbydoing/sd/1000mac.xlsx')
date_map = {"2017-03-19\n":1,"2017-03-20\n":2,"2017-03-21\n":3,"2017-03-22\n":4,"2017-03-23\n":5,"2017-03-24\n":6,"2017-03-25\n":7,
            "2017-03-26\n":8, "2017-03-27\n":9,"2017-03-28\n":10,"2017-03-29\n":11,"2017-03-30\n":12,"2017-03-31\n":13,
            "2017-04-01\n":14,"2017-04-02\n":15,"2017-04-03\n":16,"2017-04-04\n":17,"2017-04-05\n":18,"2017-04-06\n":19,
            "2017-04-07\n":20,"2017-04-08\n":21,"2017-04-09\n":22,"2017-04-10\n":23,"2017-04-11\n":24,"2017-04-12\n":25,
            "2017-04-13\n":26,"2017-04-14\n":27,"2017-04-15\n":28,"2017-04-16\n":29,"2017-04-17\n":30,}
print date_map['2017-03-19\n']
table = data.sheets()[1]
for i in range(10001):
    cell_value = table.cell_value(i,0)
    key = str(cell_value) + '\n'
    maps = r.hgetall(key)
    for k in maps:
        print k, "is", maps[k]
